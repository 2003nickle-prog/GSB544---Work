---
title: "Practice 6.2"
format: html
---

```{python}
import sklearn
import pandas as pd
import numpy as np
from palmerpenguins import load_penguins

penguins = load_penguins()
```

```{python}
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
import numpy as np
import pandas as pd
from plotnine import *
```

```{python}
penguins = pd.get_dummies(penguins, drop_first=True)
penguins = penguins.dropna()
penguins = penguins.astype(int)
penguins.head()
```

```{python}

y = penguins["bill_depth_mm"]
x = penguins.drop(columns=["bill_depth_mm"])
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2)

models = {
    "Model 1": ["bill_length_mm"],
    "Model 2": ["bill_length_mm", "flipper_length_mm"],
    "Model 3": ["bill_length_mm", "flipper_length_mm", "body_mass_g"],
    "Model 4": ["bill_length_mm", "flipper_length_mm", "body_mass_g",
                "species_Chinstrap", "species_Gentoo", "island_Dream",
                "island_Torgersen", "sex_male"]
}

rows=[]
for name, xcols in models.items():
    model = LinearRegression().fit(x_train[xcols], y_train)
    training_y_pred = model.predict(x_train[xcols])
    mse_train=mean_squared_error(y_train, training_y_pred)
    rows.append([name, mse_train, np.sqrt(mse_train)])
train_error=pd.DataFrame(rows, columns=["Model", "MSE", "RMSE"])

rows=[]
for name, xcols in models.items():
    model = LinearRegression().fit(x_train[xcols], y_train)
    test_y_pred = model.predict(x_test[xcols])
    mse_test=mean_squared_error(y_test, test_y_pred) # Corrected to use y_test and test_y_pred
    rows.append([name, mse_test, np.sqrt(mse_test)])
test_error=pd.DataFrame(rows, columns=["Model", "MSE", "RMSE"])

df_error=train_error.merge(test_error, on="Model", suffixes=('_train', '_test')) # Added suffixes for clarity
df_error_long=pd.melt(df_error, id_vars=["Model"], value_vars=["RMSE_train", "RMSE_test"], value_name="RMSE", var_name="type")

(ggplot(df_error_long, aes(x="Model", y="RMSE", fill="type")) 
+geom_col(position = "dodge")
+labs(x="Model", y="RMSE", fill="")
)
```


